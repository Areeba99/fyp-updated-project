{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Ali\\\\Desktop\\\\fyp\\\\EXPO\\\\screens\\\\NotificationScreen.js\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport { Avatar, Button, Input, ListItem, Text, Divider } from \"react-native-elements\";\nimport UserContext from \"../connection/userContext\";\nimport { Firebase } from \"../connection/comms\";\nimport * as Notifications from \"expo-notifications\";\nimport firebase from \"firebase\";\nexport default function NotificationScreen(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useContext = useContext(UserContext),\n      loggedIn = _useContext.loggedIn;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      notifs = _useState2[0],\n      setNotifs = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      Loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      refreshing = _useState6[0],\n      setRefreshing = _useState6[1];\n\n  useEffect(function () {\n    var unsub = firebase.firestore().collection(\"Orders\").onSnapshot(function (snapshot) {\n      console.log(\"snapshot2\");\n\n      for (var _iterator = _createForOfIteratorHelperLoose(snapshot.docChanges()), _step; !(_step = _iterator()).done;) {\n        var change = _step.value;\n\n        if (change.type === \"added\") {\n          var data = change.doc.data();\n\n          if (data.seller === loggedIn.uid) {\n            var content = {\n              title: 'New Order',\n              body: \"Please check and agree if you want to work on it.\"\n            };\n            Notifications.scheduleNotificationAsync({\n              content: content,\n              trigger: null\n            }).then(function (r) {\n              return console.log(\"Notification -> \" + r);\n            });\n          }\n        }\n\n        if (change.type === \"modified\") {\n          var _data = change.doc.data();\n\n          if (_data.buyer === loggedIn.uid && _data.accepted === true && _data.delivered === false && _data.complated === false) {\n            var _content = {\n              title: 'Seller agreed to work.',\n              body: \"Seller has agreed to work on the following service: \" + _data.title\n            };\n            Notifications.scheduleNotificationAsync({\n              content: _content,\n              trigger: null\n            }).then(function (r) {\n              return console.log(\"Notification -> \" + r);\n            });\n          }\n\n          if (_data.buyer === loggedIn.uid && _data.accepted === true && _data.delivered === true && _data.complated === false) {\n            var _content2 = {\n              title: 'Seller has completed working..',\n              body: \"Seller has completed work on the following service: \" + _data.title\n            };\n            Notifications.scheduleNotificationAsync({\n              content: _content2,\n              trigger: null\n            }).then(function (r) {\n              return console.log(\"Notification -> \" + r);\n            });\n          }\n\n          if (_data.seller === loggedIn.uid && _data.accepted === true && _data.delivered === true && _data.complated === true) {\n            var _content3 = {\n              title: 'Order Completed',\n              body: \"Buyer has accepted your order #\" + _data.id\n            };\n            Notifications.scheduleNotificationAsync({\n              content: _content3,\n              trigger: null\n            }).then(function (r) {\n              return console.log(\"Notification -> \" + r);\n            });\n          }\n        }\n      }\n    });\n    return function () {\n      unsub();\n    };\n  }, []);\n\n  var loadDataInView = function loadDataInView() {\n    console.log(\"LoadDataInView\");\n    firebase.firestore().collection(\"notifications\").doc(loggedIn.uid).collection(\"notifs\").get().then(function (snapshot) {\n      var dataArray = [];\n      snapshot.docs.forEach(function (doc) {\n        var data = doc.data();\n        data.id = doc.id;\n        dataArray.push(data);\n      });\n      console.log(dataArray);\n      setNotifs(dataArray);\n      setLoading(false);\n      setRefreshing(false);\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n\n  useEffect(function () {\n    var _route$params;\n\n    if ((_route$params = route.params) != null && _route$params.reload) {\n      loadDataInView();\n    }\n\n    console.log(\"Effect Seller Services\");\n\n    if (Loading === true) {\n      loadDataInView();\n    }\n  }, [navigation, route]);\n\n  var onRefresh = function onRefresh() {\n    setRefreshing(true);\n    setLoading(true);\n    loadDataInView();\n  };\n\n  return React.createElement(UserContext.Consumer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, function (_ref2) {\n    var loggedIn = _ref2.loggedIn,\n        setLoggedin = _ref2.setLoggedin;\n    return React.createElement(KeyboardAvoidingView, {\n      behavior: Platform.OS === \"ios\" ? \"padding\" : \"padding\",\n      style: styles.container,\n      keyboardVerticalOffset: 100,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }\n    }, React.createElement(ScrollView, {\n      style: styles.container,\n      contentContainerStyle: styles.contentContainer,\n      refreshControl: React.createElement(RefreshControl, {\n        refreshing: refreshing,\n        onRefresh: onRefresh,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 49\n        }\n      }),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 21\n      }\n    }, notifs && notifs.map(function (s, k) {\n      return React.createElement(ListItem, {\n        key: k,\n        title: s.title,\n        subtitle: s.body,\n        subtitleStyle: {\n          color: \"grey\"\n        },\n        bottomDivider: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 29\n        }\n      });\n    }), notifs && notifs.length < 1 ? React.createElement(Text, {\n      style: {\n        fontSize: 12,\n        color: \"grey\",\n        textAlign: \"center\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 56\n      }\n    }, \"No Notifications for you.\") : null));\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff'\n  },\n  contentContainer: {\n    paddingTop: 30,\n    paddingBottom: 20\n  }\n});","map":{"version":3,"sources":["C:/Users/Ali/Desktop/fyp/EXPO/screens/NotificationScreen.js"],"names":["React","useContext","useEffect","useState","Avatar","Button","Input","ListItem","Text","Divider","UserContext","Firebase","Notifications","firebase","NotificationScreen","navigation","route","loggedIn","notifs","setNotifs","Loading","setLoading","refreshing","setRefreshing","unsub","firestore","collection","onSnapshot","snapshot","console","log","docChanges","change","type","data","doc","seller","uid","content","title","body","scheduleNotificationAsync","trigger","then","r","buyer","accepted","delivered","complated","id","loadDataInView","get","dataArray","docs","forEach","push","catch","err","params","reload","onRefresh","setLoggedin","Platform","OS","styles","container","contentContainer","map","s","k","color","length","fontSize","textAlign","StyleSheet","create","flex","backgroundColor","paddingTop","paddingBottom"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\r\nimport {KeyboardAvoidingView, ScrollView, StyleSheet, View, Platform, TextInput, RefreshControl,} from 'react-native';\r\nimport {Avatar, Button, Input, ListItem, Text, Divider} from \"react-native-elements\";\r\nimport UserContext from \"../connection/userContext\";\r\nimport {Firebase} from \"../connection/comms\";\r\nimport * as Notifications from \"expo-notifications\";\r\nimport firebase from \"firebase\";\r\n\r\nexport default function NotificationScreen({navigation, route}) {\r\n    const {loggedIn} = useContext(UserContext)\r\n    const [notifs, setNotifs] = useState(null)\r\n    const [Loading, setLoading] = useState(true)\r\n    const [refreshing, setRefreshing] = useState(false);\r\n\r\n    useEffect(() => {\r\n\r\n        let unsub = firebase.firestore()\r\n            .collection(\"Orders\")\r\n            .onSnapshot((snapshot) => {\r\n                console.log(\"snapshot2\")\r\n                for (const change of snapshot.docChanges()) {\r\n                    if (change.type === \"added\") {\r\n                        let data = change.doc.data();\r\n                        if (data.seller === loggedIn.uid) {\r\n                            const content = {\r\n                                title: 'New Order',\r\n                                body: \"Please check and agree if you want to work on it.\"\r\n                            };\r\n                            Notifications.scheduleNotificationAsync({content, trigger: null})\r\n                                .then(r => console.log(\"Notification -> \" + r));\r\n                        }\r\n                    }\r\n                    if (change.type === \"modified\") {\r\n                        let data = change.doc.data();\r\n\r\n                        if (data.buyer === loggedIn.uid && data.accepted === true && data.delivered === false && data.complated === false) {\r\n                            const content = {\r\n                                title: 'Seller agreed to work.',\r\n                                body: \"Seller has agreed to work on the following service: \"+data.title\r\n                            };\r\n                            Notifications.scheduleNotificationAsync({content, trigger: null})\r\n                                .then(r => console.log(\"Notification -> \" + r));\r\n                        }\r\n                        if (data.buyer === loggedIn.uid && data.accepted === true && data.delivered === true && data.complated === false) {\r\n                            const content = {\r\n                                title: 'Seller has completed working..',\r\n                                body: \"Seller has completed work on the following service: \"+data.title\r\n                            };\r\n                            Notifications.scheduleNotificationAsync({content, trigger: null})\r\n                                .then(r => console.log(\"Notification -> \" + r));\r\n                        }\r\n                        if (data.seller === loggedIn.uid && data.accepted === true && data.delivered === true && data.complated === true) {\r\n                            const content = {\r\n                                title: 'Order Completed',\r\n                                body: \"Buyer has accepted your order #\" + data.id\r\n                            };\r\n                            Notifications.scheduleNotificationAsync({content, trigger: null})\r\n                                .then(r => console.log(\"Notification -> \" + r));\r\n                        }\r\n                        // const content = {title: 'Order Modified.', body: \"Service: \"+change.doc.data().title};\r\n                        // return firebase.firestore()\r\n                        //     .collection(\"notifications\")\r\n                        //     .doc(loggedIn.uid)\r\n                        //     .collection(\"notifs\")\r\n                        //     .add(content)\r\n                        //     .then((r) => {\r\n                        //         Notifications.scheduleNotificationAsync({content, trigger: null})\r\n                        //             .then(r => console.log(\"Notification -> \" + r));\r\n                        //         return r\r\n                        //     });\r\n                    }\r\n                }\r\n            });\r\n        return () => {\r\n            unsub()\r\n        }\r\n    }, [])\r\n\r\n    const loadDataInView = () => {\r\n        console.log(\"LoadDataInView\")\r\n        firebase.firestore()\r\n            .collection(\"notifications\")\r\n            .doc(loggedIn.uid)\r\n            .collection(\"notifs\")\r\n            .get()\r\n            .then((snapshot) => {\r\n                let dataArray = [];\r\n                snapshot.docs.forEach(doc => {\r\n                    let data = doc.data()\r\n                    data.id = doc.id\r\n                    dataArray.push(data)\r\n                });\r\n                console.log(dataArray)\r\n                setNotifs(dataArray)\r\n                setLoading(false)\r\n                setRefreshing(false)\r\n            }).catch(err => console.log(err))\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (route.params?.reload) {\r\n            loadDataInView()\r\n        }\r\n        console.log(\"Effect Seller Services\")\r\n        if (Loading === true) {\r\n            loadDataInView()\r\n        }\r\n    }, [navigation, route])\r\n\r\n    const onRefresh = () => {\r\n        setRefreshing(true)\r\n        setLoading(true)\r\n        loadDataInView()\r\n\r\n    }\r\n\r\n    return (\r\n        <UserContext.Consumer>\r\n            {({loggedIn, setLoggedin}) => (\r\n                <KeyboardAvoidingView behavior={Platform.OS === \"ios\" ? \"padding\" : \"padding\"}\r\n                                      style={styles.container} keyboardVerticalOffset={100}>\r\n                    <ScrollView style={styles.container} contentContainerStyle={styles.contentContainer}\r\n                                refreshControl={<RefreshControl refreshing={refreshing} onRefresh={onRefresh}/>}>\r\n                        {notifs && notifs.map((s, k) => (\r\n                            <ListItem key={k}\r\n                                      title={s.title}\r\n                                      subtitle={s.body}\r\n                                      subtitleStyle={{color: \"grey\"}}\r\n                                      bottomDivider\r\n                            />))}\r\n\r\n                        {notifs && notifs.length < 1 ? <Text style={{fontSize: 12, color: \"grey\", textAlign: \"center\"}}>No Notifications for you.</Text> : null}\r\n\r\n                    </ScrollView>\r\n                </KeyboardAvoidingView>\r\n\r\n            )}\r\n        </UserContext.Consumer>\r\n    );\r\n}\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        backgroundColor: '#fff',\r\n    },\r\n\r\n    contentContainer: {\r\n        paddingTop: 30,\r\n        paddingBottom: 20\r\n    },\r\n\r\n});"]},"metadata":{},"sourceType":"module"}